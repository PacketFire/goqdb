{{set . "title" "QDB"}}
{{template "header.html" .}}

<div id="main">
	<header>

		<a href="/"><h3>QDB</h3></a>

		<form class="form-inline" role="form" method="get" action="">
			<div class="form-group">
				<input class="form-control" type="search" id="search" name="search" value="{{.search}}" />
			</div>
			<button class="btn btn-primary" type="">search</button>
		</form>
	</header>
	
	<br/>

	<span class="error-message">{{if .errors}}There were errors in the form submission{{end}}</span>
	<form role="form" method="post" action="/">
		<!--
		<legend>quote</legend>
		<textarea name="quote" rows="5"></textarea>
		<br/>
		<input class="btn btn-primary" type="submit" name="submit" value="submit"/>
		-->

		<!-- Textarea -->
		{{with $field := field "entry.Quote" .}}
		<div class="form-group">
			<textarea class="form-control {{$field.ErrorClass}}" id="quote" name="entry.Quote" placeholder="quote">{{$field.Flash}}</textarea>
		</div>
		{{end}}
		<!-- Text input-->
		{{with $field := field "entry.Author" .}}
		<div class="form-group row">
			<div class="col-xs-3">
				<input class="form-control {{$field.ErrorClass}}" id="author" name="entry.Author" type="text" placeholder="author" value="{{$field.Flash}}">
			</div>
		</div>
		{{end}}

		<!-- Submit -->
		<div class="form-group">
	    	<button id="submit" name="submit" type="submit" class="btn btn-primary">submit</button>
		</div>
	</form>
	<div id="pageLinks" class="clearfix">
	<a class="btn btn-default fLeft" {{if eq .hasPrevPage false}}disabled="disabled"{{end}} href="?page={{.prevPage}}{{if .search}}&search={{.search}}{{end}}">prev</a>
	<a class="btn btn-default fRight" {{if eq .hasNextPage false}}disabled="disabled"{{end}} href="?page={{.nextPage}}{{if .search}}&search={{.search}}{{end}}">next</a>
	</div>
	
	<br/>
	
	{{$search := .search}}
	{{$page := .page}}
	{{$size := .size}}

	{{with $entries := .entries}}
	{{range $e := $entries}}
	<div class="clearfix">
		<div class="fLeft">{{$e.Author}} {{$e.Time}}</div>
		<div class="fRight">
			<a class="btn btn-danger btn-xs btn-vote" role="button" href="/down?id={{$e.QuoteId}}{{if $search}}&search={{$search}}{{end}}{{if $page}}&page={{$page}}{{end}}{{if $size}}&size={{$size}}{{end}}">-</a>
			<span>{{$e.Rating}}</span>
			<a class="btn btn-success btn-xs btn-vote" role="button" href="/up?id={{$e.QuoteId}}{{if $search}}&search={{$search}}{{end}}{{if $page}}&page={{$page}}{{end}}{{if $size}}&size={{$size}}{{end}}">+</a>
		</div>
	</div>
	<a style="display:block" href="/q/{{$e.QuoteId}}" class="quote_entry">
		<div>
			<pre>{{.Clip}}</pre>
		</div>
	</a>
	{{end}}
	{{else}}
	<p>No more results</p>
	{{end}}
</div>


{{template "footer.html" .}}
